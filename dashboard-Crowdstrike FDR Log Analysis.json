{"$schema":"https://dataexplorer.azure.com/static/d/schema/52/dashboard.json","id":"45390486-3458-4904-b52b-6bd536f66e97","eTag":"16fea625-068f-4788-b344-ff443ac75646","schema_version":"52","title":"Crowdstrike FDR Dashboard","tiles":[{"id":"fc5bf175-37ce-4151-9dc0-4dae6b4c69b6","title":"FDR Events for Host","visualType":"table","pageId":"0f36ab3c-e93f-432c-8e28-bc158eb3c347","layout":{"x":0,"y":16,"width":24,"height":17},"queryRef":{"kind":"query","queryId":"d4455a8b-7859-4af2-add2-e86ec7f26deb"},"visualOptions":{"hideLegend":false,"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"f2180597-a6a7-420c-99d3-098cbcb3150e","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"event_simpleName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"b317803d-e3f0-466c-b4bd-5cc9c3725c2c","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"ImageFileName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"03c5f832-061e-4597-8d1b-be16c1b27875","title":"AsepValueUpdate and Registry Changes","visualType":"table","pageId":"997f5fa9-b6f6-47cc-819c-6768d3af688b","layout":{"x":0,"y":0,"width":24,"height":20},"queryRef":{"kind":"query","queryId":"17b33f45-1229-4549-961e-f67b8642d0e5"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"370ce483-28d9-41d5-81fb-5eae4a60f967","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"event_simpleName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"2f27a3d0-0a8c-4ce8-8868-6d09b57cfd37","title":"CommandHistory - This event includes the full command history associated with one of the consoles in a process that has recently terminated (identified by the TargetProcessId ). Note that a given UPID may be associated with multiple consoles (identified by ApplicationName ).","visualType":"table","pageId":"97aa6290-41ef-4d8b-aa17-7936a09938f0","layout":{"x":0,"y":0,"width":24,"height":23},"queryRef":{"kind":"query","queryId":"87674250-68ef-4b8d-9dea-f972d948a023"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"1d7c9c92-bf69-4d21-9a00-8819e023df22","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"CommandHistory","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"b27651f3-88c9-497a-9efc-d3d8f4bcc224","title":"CrowdStrike Detections","visualType":"table","pageId":"5769b90d-4c07-4317-b341-7bfb7999c975","layout":{"x":0,"y":12,"width":24,"height":8},"queryRef":{"kind":"query","queryId":"fd799129-6c1e-4497-b430-34439324634c"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"1fafabca-f076-416e-8b01-459e138a2a4a","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"PatternDispositionDescription","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"09365e29-62b9-4ba8-a128-8f90b71b1fba","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"Objective","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"ece25b96-0911-4f18-a496-4fc945e4d9e3","title":"Scheduled Task Events - This event is sent when Falcon detects that a scheduled task has been added to the machine, either locally or remotely.","visualType":"table","pageId":"50042a3b-bcb9-48d9-a5d9-448225c07fb5","layout":{"x":0,"y":0,"width":23,"height":17},"queryRef":{"kind":"query","queryId":"5679debd-79e2-4e1e-8801-6225beaebbd9"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"b4f19dca-7976-45b5-b845-1c2caaddb9c7","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"event_simpleName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"16778cf7-00c4-4c59-8877-ffe5112b73cb","title":"VBScripts Observed - event_simpleName  == 'ProcessRollup2' and CommandLine contains '.vbs'","visualType":"table","pageId":"d97a4a29-c918-42d8-8cb9-c8b051526864","layout":{"x":0,"y":9,"width":24,"height":8},"queryRef":{"kind":"query","queryId":"692706e3-9847-4d18-9efe-b71c259da972"},"description":" WSCRIPT.EXE and CSCRIPT.EXE are almost exactly identical, except that one is flagged as a windows application and the other is flagged as a console application.","visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"c83993f0-cd43-44a6-9c32-b1c50fcd9945","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"CommandLine","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"8051a654-bebf-41e7-baa2-8265ab5f2691","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"FileName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"a80be493-6851-4cc9-89aa-3f5d2d42a8cf","title":"Scripting Events","visualType":"table","pageId":"d97a4a29-c918-42d8-8cb9-c8b051526864","layout":{"x":0,"y":0,"width":24,"height":9},"queryRef":{"kind":"query","queryId":"31842d14-0db2-46d9-b64d-3e666dc7bcc2"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"51773295-6f7e-481a-aed8-e67bb29d371b","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"event_simpleName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"ecd59f5d-fc67-4c4f-b6fb-349a2944cc3e","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"Process","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"c212b519-8e16-4ec7-b408-7a0e105b9da2","title":"DNS Events Joined on ProcessRollup2","visualType":"table","pageId":"aa6fa232-f89c-4e30-95a7-8863e0c6769b","layout":{"x":0,"y":25,"width":23,"height":8},"queryRef":{"kind":"query","queryId":"383d4a11-3e35-4345-81fc-d0750d5ca337"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"ea38a81f-a906-4339-b36d-c2f9f1a774ff","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"ContextBaseFileName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"e720a7e8-e5cb-4ac4-9156-959e50a4c536","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"CommandLine","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"961c6dae-bc73-4df4-b24b-ffcf8c378a12","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"DomainName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"d50a105d-041c-440a-ab48-450c04b5953f","title":"Driver Events for Host - Looks for events containing '.sys'","visualType":"table","pageId":"b1f67b63-2d7a-439b-bfc9-4d68da320942","layout":{"x":0,"y":0,"width":24,"height":20},"queryRef":{"kind":"query","queryId":"4a71a072-c363-4011-94d5-4ce0085db38b"},"visualOptions":{"hideLegend":false,"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"f2180597-a6a7-420c-99d3-098cbcb3150e","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"ImageFileName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"20e151ff-aa8a-4fae-b7c3-fc105071dd2b","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":null,"themeName":"traffic-lights","maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"424adbd7-8ff9-491d-ae8f-c3d6537bf213","title":"MacroContentInfo - Provides information about a macro extracted when an Office file is written or opened","visualType":"table","pageId":"d00df8d1-d3f8-46f5-97b8-4c6c6736b776","layout":{"x":0,"y":0,"width":24,"height":21},"queryRef":{"kind":"query","queryId":"da7ea02b-f1fa-46f3-a33d-b754c4c96845"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[]}},{"id":"538b67fd-6c70-482d-8edb-7141a9ba60f4","title":"InstalledApplications - An event that describes a single application. E.g. representing a newly installed application, one just removed, or one discovered during enumeration.","visualType":"table","pageId":"0086f241-5100-41e2-bca9-776a3be2cc5a","layout":{"x":0,"y":0,"width":24,"height":16},"queryRef":{"kind":"query","queryId":"a2ec1513-f36d-46a4-9f6c-26ef1fa1b2aa"},"description":"Hash not in this event type... \n\n    AppIs64Bit,\n    SHA256HashData, \n    SHA1HashData,\n    MD5HashData,\n    tostring(record)","visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"36877b5f-8193-4692-92a0-3feb4dc6d020","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"AppVendor","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"04470d92-7aa2-4eb7-94f2-fcaa57f107c8","title":"Agent Online - This event is generated when any of these occur:1. A host is turned on or rebooted   2. A new sensor is installed on a host   3. An existing sensor is updated","visualType":"table","pageId":"28efb10e-d7fc-4255-b70e-a7b07095f77e","layout":{"x":0,"y":13,"width":24,"height":12},"queryRef":{"kind":"query","queryId":"ec44d11d-7ac8-4146-a3d4-2acc5780a6b0"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[]}},{"id":"4187f7bc-e4db-43d6-a48c-1576e68b4290","title":"Downloads Directory - Looks for files in a User's Downloads Directory (Windows)","visualType":"table","pageId":"0ff9504d-4c7d-4459-be11-d1929cec92eb","layout":{"x":0,"y":0,"width":24,"height":13},"queryRef":{"kind":"query","queryId":"a3050b43-5e2b-4957-80e7-1d1c84109622"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"6962e899-6081-4d48-af8c-fe0a3a5f5d8b","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"FileName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"a16a5fc3-d12a-4604-9d67-88ab400fe316","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"event_simpleName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"dce971de-1510-4fbe-92fb-0d8b96a3557b","title":"Run Keys","visualType":"table","pageId":"85ccc62c-be52-49ca-97e7-d519aa4f371b","layout":{"x":0,"y":0,"width":24,"height":21},"queryRef":{"kind":"query","queryId":"11bdb4ee-420c-4934-a891-124165090238"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"b529d2b3-1f7f-436f-8df2-cc9d3ad7d18d","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"RegValueName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"45d3cb80-0c6d-41e0-b6f3-98f848eb7c99","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"RegObjectName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"5e0e63fd-5dbd-47b9-8964-75bc7a71a232","title":"Logs by Event Simple Name","visualType":"table","pageId":"0f36ab3c-e93f-432c-8e28-bc158eb3c347","layout":{"x":0,"y":7,"width":24,"height":9},"queryRef":{"kind":"query","queryId":"a8162829-5719-4459-b241-a5e69cf45abe"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"9851038c-3a85-42f7-b263-ece572f7088b","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"event_simpleName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"75855802-d4e4-4d3a-9af6-04dc4163efc0","title":"SensorHeartbeat - Sent periodically to inform the cloud that the sensor is active.","visualType":"table","pageId":"28efb10e-d7fc-4255-b70e-a7b07095f77e","layout":{"x":0,"y":3,"width":24,"height":10},"queryRef":{"kind":"query","queryId":"59c05b15-1f1d-4c14-b1d4-90bc38799eef"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[]}},{"id":"ab92fbb4-b97e-4dc2-8bb9-ce75671f1d36","title":"LFODownloadConfirmation - Thrown when the agent receives an LFODownload event. (channel download)","visualType":"table","pageId":"0a264bc6-636b-43a8-8115-ab82a8488de8","layout":{"x":0,"y":0,"width":24,"height":21},"queryRef":{"kind":"query","queryId":"c8c2adfa-c66c-4414-bf9a-c70bc0d4c96c"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"861a8dfb-e864-43fc-83a3-b710144d5f2b","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"CompletionEventId","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"875faeb9-ba34-499d-a5d9-d609e06b3e17","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"TargetFileName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"dbf36591-2014-4b06-893e-0e3dd2c8d327","title":"Host Overview","visualType":"table","pageId":"5769b90d-4c07-4317-b341-7bfb7999c975","layout":{"x":0,"y":7,"width":24,"height":5},"queryRef":{"kind":"query","queryId":"46b61941-56ae-492d-9a4e-b38390969db6"},"visualOptions":{"table__enableRenderLinks":false,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"c302d985-bbe6-4067-ac08-7c3e0b0fd3cc","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"column":null,"operator":">","values":[""]}],"chainingOperator":"and","colorStyle":"bold","color":null,"tag":"","icon":null,"ruleName":"","visualType":"table"},{"id":"19bf0773-0d1d-4b08-bc46-42420fdf7084","ruleType":"colorByValue","ruleName":"","applyTo":"rows","column":"HostInfo","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"4ffda0c5-a2c9-4796-bb4c-1a3ddeab573d","title":"","visualType":"markdownCard","pageId":"5769b90d-4c07-4317-b341-7bfb7999c975","layout":{"x":0,"y":0,"width":24,"height":7},"markdownText":"#### CrowdStrike Host Console\r\n<your link here>\r\n\r\n#### CrowdStrike Identity Protection Console\r\n<your link here>\r\n\r\n\r\n#### Playbooks\r\n<your link here>\r\n\r\n\r\n#### Events Data Dictionary\r\n<your link here>\r\n\r\n","visualOptions":{}},{"id":"9391074e-f245-4618-ab3e-ab4d320916e4","title":"CrowdStrike Identity Protection Alerts","visualType":"table","pageId":"5769b90d-4c07-4317-b341-7bfb7999c975","layout":{"x":0,"y":20,"width":24,"height":7},"queryRef":{"kind":"query","queryId":"3d311d0f-fc60-402c-8ba1-440abd0bae35"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"687b2b0e-4d15-4b33-a844-2072cd02895f","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"incidentDescription","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"9e8b0ffa-6b9b-45f5-a311-3d5216bcf8dd","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"sourceAccountUpn","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"cf768ea4-798f-4ef0-bb16-d5fc80ae0858","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"severityName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"cb7eb39e-9a14-47fa-9a41-190d1b8299b3","title":"Python File Written","visualType":"table","pageId":"d97a4a29-c918-42d8-8cb9-c8b051526864","layout":{"x":0,"y":17,"width":24,"height":8},"queryRef":{"kind":"query","queryId":"174a707d-bbef-4571-9469-ba73c9e43a51"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[]}},{"id":"e3c08933-3ac9-4d2d-b010-ae117af1aad4","title":"DNS Request Logs Containing Artifact Token","visualType":"table","pageId":"aa6fa232-f89c-4e30-95a7-8863e0c6769b","layout":{"x":0,"y":0,"width":15,"height":15},"queryRef":{"kind":"query","queryId":"b0a7bad9-aaa1-4779-9c15-9182ebee1d6e"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"1aa5a653-a053-4d89-b7b8-f35c251374d7","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"DomainName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"73e7ee99-1433-4d93-b7e3-6259773313f6","title":"Top DNS Requests","visualType":"pie","pageId":"aa6fa232-f89c-4e30-95a7-8863e0c6769b","layout":{"x":15,"y":0,"width":8,"height":15},"queryRef":{"kind":"query","queryId":"90d868d8-0b95-4e98-bbcc-6d90a27e2de3"},"visualOptions":{"hideLegend":false,"legendLocation":"bottom","xColumn":null,"yColumns":null,"seriesColumns":null,"crossFilterDisabled":false,"drillthroughDisabled":false,"labelDisabled":false,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","pie__topNSlices":null,"crossFilter":[],"drillthrough":[]}},{"id":"47c7798e-60f0-4afe-b5a2-1e4865370511","title":"Count of Event Types","visualType":"table","pageId":"0f36ab3c-e93f-432c-8e28-bc158eb3c347","layout":{"x":0,"y":3,"width":24,"height":4},"queryRef":{"kind":"query","queryId":"d06c7471-e1d5-48ca-a1e7-f2371a910d0b"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"9a120c63-d9d7-44e0-a24a-574b56c5bd9f","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"column":null,"operator":">","values":[""]}],"chainingOperator":"and","colorStyle":"bold","color":null,"tag":"","icon":null,"ruleName":"","visualType":"table"}]}},{"id":"b595bc2a-6531-4f2e-a7fa-0cc369af2c31","title":"Installed Browser Extension","visualType":"table","pageId":"0086f241-5100-41e2-bca9-776a3be2cc5a","layout":{"x":0,"y":16,"width":24,"height":8},"queryRef":{"kind":"query","queryId":"ac2726bb-a67a-43cc-8677-a688818be51a"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"06638288-9822-405f-b723-b0eece6e5fcd","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"BrowserFilePath","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"d323c5e1-b001-47a3-a918-1c441815c729","title":"USB Events - An event that describes a connected USB device to which Device Control is attached. It is sent each time the system powers on, the associated hub/port ispower cycled, or the device is physically inserted into the system.","visualType":"table","pageId":"a69bbbb2-c23e-42d8-ab4a-62d8fd612836","layout":{"x":0,"y":0,"width":24,"height":21},"queryRef":{"kind":"query","queryId":"64ec6bef-0d34-41b2-87aa-0fec27258bec"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"76f01a98-dcb0-4ef8-a5b7-b08503a71070","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"DeviceProduct","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"bf214dbb-8bc4-4780-9cfc-9093906d55da","title":"Process Injection Events","visualType":"table","pageId":"06e706a9-a1e9-4b02-b4d3-d3875b6e6f95","layout":{"x":0,"y":0,"width":24,"height":21},"queryRef":{"kind":"query","queryId":"9a9194e8-b185-4364-a1ce-6ef8e1177e57"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"1036843a-4c80-45a4-b70d-9cfe4d64bcb0","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"InjectorImageFileName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"66953762-a173-4c45-a9c8-1d7de20a412b","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"InjecteeImageFileName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"cfe0010f-18ba-4d6b-b0c1-f18d17628fa8","title":"Active Directory Events","visualType":"table","pageId":"54700954-40a4-42c1-80ac-ab142ab6a863","layout":{"x":0,"y":0,"width":24,"height":20},"queryRef":{"kind":"query","queryId":"4ce8fedc-62bd-44c7-900c-49d4932738c1"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"7503e0ed-3e0c-4e27-9865-c4d36bfa5802","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"event_simpleName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"6f478628-5625-4c83-b244-7e4c33219bf2","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"UserName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"ae59c5c0-76e6-49c2-9d6c-2ebdd03304ac","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"name","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"f59f6364-a0b2-4613-8ddf-6d132c99f5ce","title":"","visualType":"markdownCard","pageId":"0f36ab3c-e93f-432c-8e28-bc158eb3c347","layout":{"x":0,"y":0,"width":24,"height":3},"markdownText":"For best performance, adjust the time range down to smaller increments e.g 2-6 hour chunks rather than 'last 24 hours'. Consider also narrowing search down to specific events by selecting specific event names. \r\n* Artifact search box can be left as is or can be populated","visualOptions":{}},{"id":"79f4970e-2827-4eeb-ac34-488c1a1b82bc","title":"Network Connect Events","visualType":"table","pageId":"15a8edd7-6206-42bf-9fbf-9b0ea45b07d3","layout":{"x":0,"y":2,"width":24,"height":21},"queryRef":{"kind":"query","queryId":"cf793f13-2080-427a-8e76-d28225485de5"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"ab8d66ab-eaa2-4d7d-8a85-0448296afd37","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"event_simpleName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"084ab972-027e-4d3e-a07f-722935204b20","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"RemoteAddressIP4","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"c952d737-dbda-43a1-b7a6-147c470c3ba6","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"ConnectionDirection","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"0ff6052a-2d9e-417a-a31a-5997344def2d","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"FirewallRuleAction","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"4bb74a5a-570d-4adb-b526-65136522459c","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"RemoteAddressIP","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"121b77fb-a1a0-4ac4-91a6-231102601576","title":"New tile","visualType":"markdownCard","pageId":"28efb10e-d7fc-4255-b70e-a7b07095f77e","layout":{"x":0,"y":0,"width":24,"height":3},"markdownText":"Consider creating a scheduled search to alert SOC when a host is online\n<your link here>\n","visualOptions":{}},{"id":"4cfb0362-dd60-45c9-b7a6-d2ffa1f9ed25","title":"Volume Snapshot Events","visualType":"table","pageId":"2c5e9613-72e0-4a56-b7dc-9a2b9d21587c","layout":{"x":0,"y":0,"width":24,"height":21},"queryRef":{"kind":"query","queryId":"215ad230-cd3f-413a-a06a-914aeeafb11c"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"01b6409f-fdbf-4c5e-a5c4-8c3381618537","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"UserName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"745d9edd-c64e-449b-951f-ed455db18896","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"event_simpleName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"7b44007b-bfd5-42da-8c59-47d8adab4ff3","title":"Authentication Events","visualType":"table","pageId":"fed716b6-b43f-4618-8207-2e103bf579b4","layout":{"x":0,"y":0,"width":24,"height":20},"queryRef":{"kind":"query","queryId":"479282b5-c670-4ee5-889d-3b2057bb5295"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"7503e0ed-3e0c-4e27-9865-c4d36bfa5802","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"event_simpleName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"6f478628-5625-4c83-b244-7e4c33219bf2","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"UserName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"67c9a910-4779-470c-9276-567c04417532","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"ClientComputerName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"9284199d-edf0-46cb-b2a8-55518aecf658","title":"Leverages Agent Online Events - This event is generated when any of these occur:1. A host is turned on or rebooted   2. A new sensor is installed on a host   3. An existing sensor is updated","visualType":"table","pageId":"c73d4da1-795c-4f2e-b85a-4b523141c344","layout":{"x":0,"y":14,"width":24,"height":12},"queryRef":{"kind":"query","queryId":"2845ff38-1015-4e49-9ab5-8b63de7ba57d"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[]}},{"id":"a4e54669-0fdf-46e6-b725-567ea7b1a631","title":"Email Archive File Written Events","visualType":"table","pageId":"0a05c95e-236f-473f-a843-de47890f4092","layout":{"x":0,"y":0,"width":24,"height":20},"queryRef":{"kind":"query","queryId":"bb566022-a1e3-4698-ad88-d70462a33edd"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"7503e0ed-3e0c-4e27-9865-c4d36bfa5802","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"event_simpleName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"6f478628-5625-4c83-b244-7e4c33219bf2","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"UserName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"ae59c5c0-76e6-49c2-9d6c-2ebdd03304ac","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"name","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"c4ebba89-9573-4037-955a-4848c0cc172b","title":"FsVolumeMounted Events - Provides information about a mounted volume.","visualType":"table","pageId":"9d7e1ab5-4c80-4bb4-95f1-6d7a34a6234d","layout":{"x":0,"y":3,"width":24,"height":20},"queryRef":{"kind":"query","queryId":"31342c99-8362-4660-a849-57f78aefd63b"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"7503e0ed-3e0c-4e27-9865-c4d36bfa5802","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"ComputerName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"6f478628-5625-4c83-b244-7e4c33219bf2","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"AzureNetAppDeviceName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"ae59c5c0-76e6-49c2-9d6c-2ebdd03304ac","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"VolumeDriveLetter","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"ff1ade40-2f09-4b41-acca-19e4e55e7233","title":"File Write Events","visualType":"table","pageId":"a73a8f02-c093-43dc-b017-1a42a75327c8","layout":{"x":0,"y":0,"width":24,"height":20},"queryRef":{"kind":"query","queryId":"ba4fbbe6-b4e8-4f4b-849b-c474a65e958e"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"7503e0ed-3e0c-4e27-9865-c4d36bfa5802","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"event_simpleName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"6f478628-5625-4c83-b244-7e4c33219bf2","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"UserName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"ae59c5c0-76e6-49c2-9d6c-2ebdd03304ac","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"name","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"35ccda77-0b52-4946-b936-69c2ac1f3fd3","title":"","visualType":"markdownCard","pageId":"15a8edd7-6206-42bf-9fbf-9b0ea45b07d3","layout":{"x":0,"y":0,"width":24,"height":2},"markdownText":"For best performance, adjust the time range down to smaller increments e.g 2-6 hour chunks rather than 'last 24 hours'. \r\nHostname MUST be populated. Artifact is optional. ","visualOptions":{}},{"id":"79fbb179-1f9d-4b4b-8599-f7714e6a2db2","title":"Associate Indicator","visualType":"table","pageId":"af310c24-7f9d-4ae7-84c9-1e58cb5af914","layout":{"x":0,"y":2,"width":24,"height":20},"queryRef":{"kind":"query","queryId":"3db81965-f04d-435d-8753-5d1b3fbf4406"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[]}},{"id":"bae33324-5cc8-4c01-94d0-80e1e3db462e","title":"New tile","visualType":"markdownCard","pageId":"af310c24-7f9d-4ae7-84c9-1e58cb5af914","layout":{"x":0,"y":0,"width":24,"height":2},"markdownText":"This event is generated when the sensor generates an indicator. An indicator is like a detection event ( AssociateTreeIdWithRoot ) except that it is not necessarily malicious, either because it is just an indicator (e.g. when a process opens the Recycle Bin) or because CrowdStrike is not yet confident enough inthe indicator to trigger it as a detection. Note that a detection, unlike an indicator, establishes a detection tree ( AssociateTreeIdWithRoot ) which causes thesensor to send additional information for that process tree for analysis/hunting purposes. An indicator is just a single event that has no other sensor impact.","visualOptions":{}},{"id":"1d65f573-8460-424f-9301-d44a7076acdc","title":"Process ID Pivot","visualType":"table","pageId":"af310c24-7f9d-4ae7-84c9-1e58cb5af914","layout":{"x":0,"y":27,"width":24,"height":11},"queryRef":{"kind":"query","queryId":"1f24d71d-9fb0-403a-b5bd-7461e46d2503"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"ff659fa8-4814-406b-9f16-93a3f9fdd53b","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"event_simpleName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"96068850-510b-4596-bb5f-0714659f9320","title":"Event Types Containing Process ID","visualType":"table","pageId":"af310c24-7f9d-4ae7-84c9-1e58cb5af914","layout":{"x":0,"y":22,"width":24,"height":5},"queryRef":{"kind":"query","queryId":"57a7d018-55a8-4a79-9987-9f98e2749d51"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"c536bbf5-cb42-400c-a1fc-f2d58ee4cb65","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"event_simpleName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}},{"id":"8e963fd0-f882-4f09-90dc-74e050387844","title":"Downloads Directory - Looks for files in a User's Downloads Directory (Macintosh)","visualType":"table","pageId":"0ff9504d-4c7d-4459-be11-d1929cec92eb","layout":{"x":0,"y":13,"width":24,"height":13},"queryRef":{"kind":"query","queryId":"edbb3c8a-5c21-454e-a4af-a7315be762fd"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[{"id":"6962e899-6081-4d48-af8c-fe0a3a5f5d8b","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"FileName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"},{"id":"a16a5fc3-d12a-4604-9d67-88ab400fe316","ruleType":"colorByValue","ruleName":"","applyTo":"cells","column":"event_simpleName","themeName":null,"maxValue":null,"minValue":null,"reverseTheme":false,"visualType":"table"}]}}],"baseQueries":[],"parameters":[{"kind":"duration","id":"33adf2e3-b98c-49d6-9e36-020efba06e87","displayName":"Time range","description":"","beginVariableName":"_startTime","endVariableName":"_endTime","defaultValue":{"kind":"dynamic","count":15,"unit":"minutes"},"showOnPages":{"kind":"all"}},{"kind":"string","selectionType":"freetext","id":"28295aa2-69de-44a5-8804-86ce1e563eaa","displayName":"Hostname","variableName":"host_t","description":"","defaultValue":{"kind":"value","value":"UPPER CASE HOST HERE"},"showOnPages":{"kind":"all"}},{"kind":"string","id":"4220aa0e-3e87-4c31-88d2-e43cdd2fe37e","displayName":"Event Name (must insert a hostname for this to populate)","description":"","variableName":"event_simpleName_t","selectionType":"array","includeAllOption":true,"defaultValue":{"kind":"no-selection"},"dataSource":{"kind":"query","columns":{"value":"event_simpleName"},"queryRef":{"kind":"query","queryId":"072fda9c-c727-4f92-bd7f-bed1079cacda"},"autoReset":true},"showOnPages":{"kind":"selection","pageIds":["0f36ab3c-e93f-432c-8e28-bc158eb3c347"]}},{"kind":"string","selectionType":"freetext","id":"3f348ad6-1ca2-4cac-8586-f381eaa0e8a1","displayName":"Artifact (ip, url, file etc.)","variableName":"artifact_t","description":"","defaultValue":{"kind":"all"},"showOnPages":{"kind":"selection","pageIds":["0f36ab3c-e93f-432c-8e28-bc158eb3c347","aa6fa232-f89c-4e30-95a7-8863e0c6769b","15a8edd7-6206-42bf-9fbf-9b0ea45b07d3"]}},{"kind":"string","selectionType":"freetext","id":"ad5e8669-c23c-4645-8035-b1c557d80e3f","displayName":"Username","variableName":"username_t","description":"","defaultValue":{"kind":"value","value":"USERNAME HERE"},"showOnPages":{"kind":"selection","pageIds":["54700954-40a4-42c1-80ac-ab142ab6a863","fed716b6-b43f-4618-8207-2e103bf579b4","0a05c95e-236f-473f-a843-de47890f4092","9d7e1ab5-4c80-4bb4-95f1-6d7a34a6234d","a73a8f02-c093-43dc-b017-1a42a75327c8","af310c24-7f9d-4ae7-84c9-1e58cb5af914"]}},{"kind":"string","selectionType":"freetext","id":"af547f0f-916c-41aa-a1f6-9e4ef0ed5326","displayName":"Process ID Pivot","variableName":"Process_t","description":"","defaultValue":{"kind":"all"},"showOnPages":{"kind":"selection","pageIds":["af310c24-7f9d-4ae7-84c9-1e58cb5af914"]}}],"dataSources":[{"id":"e2531940-8a59-446c-8122-da1fb5dc7e6f","name":"Endpoint","scopeId":"kusto","clusterUri":"https://mpprdcuscybengadx.centralus.kusto.windows.net/","database":"Endpoint","kind":"manual-kusto"}],"pages":[{"name":"General Info","id":"5769b90d-4c07-4317-b341-7bfb7999c975"},{"name":"FDR Log Hunt","id":"0f36ab3c-e93f-432c-8e28-bc158eb3c347"},{"name":"CLI History","id":"97aa6290-41ef-4d8b-aa17-7936a09938f0"},{"name":"Scripting Events","id":"d97a4a29-c918-42d8-8cb9-c8b051526864"},{"name":"Registry Events","id":"997f5fa9-b6f6-47cc-819c-6768d3af688b"},{"name":"Scheduled Task Events","id":"50042a3b-bcb9-48d9-a5d9-448225c07fb5"},{"name":"Run Key Events","id":"85ccc62c-be52-49ca-97e7-d519aa4f371b"},{"name":"DNS Events","id":"aa6fa232-f89c-4e30-95a7-8863e0c6769b"},{"name":"Network Events","id":"15a8edd7-6206-42bf-9fbf-9b0ea45b07d3"},{"name":"Driver Events","id":"b1f67b63-2d7a-439b-bfc9-4d68da320942"},{"name":"Downloads Directory","id":"0ff9504d-4c7d-4459-be11-d1929cec92eb"},{"name":"Office Macro Events","id":"d00df8d1-d3f8-46f5-97b8-4c6c6736b776"},{"name":"Process Injection Events","id":"06e706a9-a1e9-4b02-b4d3-d3875b6e6f95"},{"id":"2c5e9613-72e0-4a56-b7dc-9a2b9d21587c","name":"VolumeSnapshot Events"},{"name":"USB Events","id":"a69bbbb2-c23e-42d8-ab4a-62d8fd612836"},{"name":"Active Directory Events","id":"54700954-40a4-42c1-80ac-ab142ab6a863"},{"id":"fed716b6-b43f-4618-8207-2e103bf579b4","name":"Authentication Events"},{"name":"Installed Applications and Extensions","id":"0086f241-5100-41e2-bca9-776a3be2cc5a"},{"id":"a73a8f02-c093-43dc-b017-1a42a75327c8","name":"File Write Events"},{"id":"0a05c95e-236f-473f-a843-de47890f4092","name":"EmailArchiveFileWritten"},{"id":"9d7e1ab5-4c80-4bb4-95f1-6d7a34a6234d","name":"FsVolumeMounted"},{"name":"Channel Downloads","id":"0a264bc6-636b-43a8-8115-ab82a8488de8"},{"id":"c73d4da1-795c-4f2e-b85a-4b523141c344","name":"BIOS Info"},{"name":"Host/Sensor Online Status","id":"28efb10e-d7fc-4255-b70e-a7b07095f77e"},{"name":"Associate Indicator","id":"af310c24-7f9d-4ae7-84c9-1e58cb5af914"}],"queries":[{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR \n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName contains (host_t)\n| where event_simpleName has_any (event_simpleName_t)\n| where * contains (artifact_t) \n| project\n    TimeGenerated,\n    ComputerName,\n    event_simpleName,\n    FileName,\n    ContextBaseFileName,\n    ImageFileName,\n    TargetFileName,\n    ParentBaseFileName,\n    GrandParentBaseFileName,\n    QuarantinedFileName,\n    CommandLine,\n    record","id":"d4455a8b-7859-4af2-add2-e86ec7f26deb","usedVariables":["_endTime","_startTime","artifact_t","event_simpleName_t","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName contains (host_t)\n| where event_simpleName == \"AsepValueUpdate\" or event_simpleName contains \"Reg\"\n| where event_simpleName != \"ScheduledTaskRegistered\"\n| project\n    TimeGenerated,\n    ComputerName,\n    UserName,\n    CommandLine,\n    event_simpleName,\n    RegObjectName,\n    RegValueName,\n    RegStringValue,\n    TargetFileName,\n    ImageFileName,\n    FileName,\n    DiskParentDeviceInstanceId","id":"17b33f45-1229-4549-961e-f67b8642d0e5","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR \n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName == (host_t) and event_simpleName == \"CommandHistory\" \n| project\n    TimeGenerated,\n    UserName,\n    TargetProcessId,\n    ComputerName,\n    CommandHistory_split =  split(CommandHistory, \"¶\"),\n    CommandCount","id":"87674250-68ef-4b8d-9dea-f972d948a023","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR \n| where ExternalApiType  == 'Event_DetectionSummaryEvent' | where TimeGenerated between (_startTime.._endTime) \n| where ComputerName contains (host_t) \n| project TimeGenerated, ComputerName,UserName, DetectDescription,PatternDispositionDescription, PatternDispositionFlags, Objective,Tactic,Technique,  FileName, CommandLine, ParentImageFileName, ParentCommandLine, GrandparentImageFileName,GrandparentCommandLine, QuarantinedFileName,  SHA256HashData, FalconHostLink, record","id":"fd799129-6c1e-4497-b430-34439324634c","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime.._endTime) \n| where ComputerName contains (host_t) \n| where event_simpleName has  \"ScheduledTask\"//cannot do startswith as some events are RemediationActionScheduledTaskRemoval\n| project TimeGenerated,ComputerName,event_simpleName,TaskName, TaskExecArguments, TaskExecCommand,  TaskXml, UserName","id":"5679debd-79e2-4e1e-8801-6225beaebbd9","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR \n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName contains (host_t) \n| where event_simpleName == 'ProcessRollup2' and CommandLine contains '.vbs'\n| project\n    TimeGenerated,\n    UserName,\n    ComputerName,\n    event_simpleName,\n    FileName,\n    ImageFileName,\n    ParentBaseFileName,\n    CommandLine,\n    SHA256HashData","id":"692706e3-9847-4d18-9efe-b71c259da972","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime .. _endTime)\n| where event_simpleName startswith \"Script\"\n    or event_simpleName == \"CommandHistory\"\n    or event_simpleName == \"NewScriptWritten\"\n| where ComputerName contains (host_t)\n| where not (ScriptContentName has_any (\"_PSScriptPolicyTest\", \"ZSATunnel\", \"settings.dat\", \"LoginScript-v3.vbs\", \"SetDefaultPrinter.vbs\", \"ParseLogUA.vbs\", \"Setup.vbs\", \"RAmapdrives-v2.vbs\", \"Delete-IECache-v2.1.vbs\", \"F12Disable.vbs\", \"brdnssuffix.vbs\", \"Uninstall.vbs\"))\n| where not (CommandLine has_any (\"Nexthink\\\\RemoteActions\")) \n| where FileName !contains (\"PSScriptPolicyTest\")\n| project\n    TimeGenerated,\n    ComputerName,\n    ScriptContentName,\n    Process=FileName,\n    ScriptContent,\n    CommandLine,\n    CommandHistory,\n    record,\n    event_simpleName","id":"31842d14-0db2-46d9-b64d-3e666dc7bcc2","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime .. _endTime)  \n| where event_simpleName == 'DnsRequest'\n| where DomainName has (artifact_t)\n| where ComputerName contains (host_t)\n| project\n    dns_event=event_simpleName,\n    DomainName,\n    ContextProcessId,\n    ContextBaseFileName,\n    dnsrequest_time=TimeGenerated,\n    TargetProcessId=ContextProcessId, \n    record\n| join\n    (\n    CrowdStrikeFDR\n    | where TimeGenerated between (_startTime .. _endTime)  \n    | where event_simpleName == 'ProcessRollup2' and ComputerName contains (host_t)\n    | project\n        processrollup_event=event_simpleName,\n        processrollup_time=TimeGenerated,\n        TargetProcessId,\n        SourceProcessId,\n        CommandLine,\n        ImageFileName,\n        record\n    )\n    on TargetProcessId\n| project\n    dnsrequest_time,\n    processrollup_time,\n    TargetProcessId,\n    CommandLine,\n    ContextBaseFileName,\n    ImageFileName,\n    DomainName,\n    record,\ndns_event,\nprocessrollup_event\n//| summarize count() by ContextBaseFileName, tostring(DomainName)","id":"383d4a11-3e35-4345-81fc-d0750d5ca337","usedVariables":["_endTime","_startTime","artifact_t","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR \n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName contains (host_t)\n| where * contains '.sys'\n| where event_simpleName != 'LFODownloadConfirmation' //when a new channel data file has been downloaded.\n| project\n    TimeGenerated,\n    ComputerName, \n    ['Event-FileName']=strcat(event_simpleName, \" - \", FileName),\n    FileName,\n    ImageFileName,\n    SHA256HashData,\n    record\n","id":"4a71a072-c363-4011-94d5-4ce0085db38b","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName contains (host_t)\n| where event_simpleName == \"MacroContentInfo\"\n| project\n    TimeGenerated,\n    event_simpleName,\n    CommandLine,\n    ScriptContent,\n    FileName,\n    ImageFileName,\n    record","id":"da7ea02b-f1fa-46f3-a33d-b754c4c96845","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR \n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName contains (host_t) \n| where event_simpleName == \"InstalledApplication\"\n| summarize\n    by\n    event_platform,\n    ComputerName,\n    event_simpleName,\n    AppName,\n    AppPath,\n    AppVendor,\n    AppVersion,\n    tostring(AppProductId),\n    AppIs64Bit,\n    SHA256HashData\n| extend AppIs64Bit = case(AppIs64Bit == \"0\", \"No\", AppIs64Bit == \"1\", \"Yes\", AppIs64Bit) \n| project\n    AppName,\n    AppVersion,\n    AppVendor,\n    ComputerName,\n    SHA256HashData,\n    AppProductId,\n    AppIs64Bit,\n    event_simpleName\n| sort by AppVendor asc","id":"a2ec1513-f36d-46a4-9f6c-26ef1fa1b2aa","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR \n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName contains (host_t) \n| where event_simpleName == 'AgentOnline'\n| project\n    TimeGenerated,\n    AgentLocalTime,\n    event_simpleName,\n    ComputerName,\n    OU,\n    SensorGroupingTags,\n    MoboManufacturer,\n    MoboProductName\n| sort by TimeGenerated desc  ","id":"ec44d11d-7ac8-4146-a3d4-2acc5780a6b0","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR \n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName contains (host_t)  and event_platform == 'Win'\n| where TargetFileName matches regex '\\\\\\\\Device\\\\\\\\HarddiskVolume\\\\d\\\\\\\\Users\\\\\\\\\\\\w+\\\\\\\\Downloads\\\\\\\\'\n| project\n    TimeGenerated,\n    event_simpleName,\n    FileName,\n    TargetFileName,\n    ContextImageFileName,\n    OriginalFilename,\n    User,\n    ComputerName,\n    record","id":"a3050b43-5e2b-4957-80e7-1d1c84109622","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName contains (host_t)\n| where event_simpleName == \"AsepValueUpdate\" or event_simpleName contains \"Reg\" \n| where RegObjectName has_any  (\n    \"\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\",\n    \"\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\",\n    \"\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnceEx\",\n    \"\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run\",\n    \"\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Shell\")\n| project\n    TimeGenerated,\n    ComputerName,\n    UserName,\n    CommandLine,\n    event_simpleName,\n    RegObjectName,\n    RegValueName,\n    RegStringValue,\n    TargetFileName,\n    ImageFileName,\n    FileName,\n    DiskParentDeviceInstanceId\n","id":"11bdb4ee-420c-4934-a891-124165090238","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR \n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName contains (host_t) \n| where event_simpleName has_any (event_simpleName_t)\n| where * contains (artifact_t)\n| summarize logs = make_set(record, 20) by event_simpleName //to prevent overloading browser only retrieve 20 sample records per event type\n\n","id":"a8162829-5719-4459-b241-a5e69cf45abe","usedVariables":["_endTime","_startTime","artifact_t","event_simpleName_t","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR \n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName contains (host_t) \n| where event_simpleName == 'SensorHeartbeat'\n| project TimeGenerated, event_simpleName, ComputerName, record\n| sort by TimeGenerated asc   ","id":"59c05b15-1f1d-4c14-b1d4-90bc38799eef","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where ComputerName == (host_t)\n    and TimeGenerated between (_startTime .. _endTime)\n| where event_simpleName == 'LFODownloadConfirmation' \n| project\n    TimeGenerated,\n    ComputerName,\n    MachineDomain,\n    CompletionEventId,\n    DownloadPath,\n    DownloadPort,\n    DownloadServer,\n    FileName,\n    TargetFileName,\n    record\n| sort by TimeGenerated","id":"c8c2adfa-c66c-4414-bf9a-c70bc0d4c96c","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where (ComputerName == (host_t) or ClientComputerName == (host_t)) and TimeGenerated between (_startTime .. _endTime)\n| where event_simpleName == 'AdditionalHostInfo'\n    or event_simpleName == 'AgentOnline'\n    or event_simpleName == 'UserLogon'\n| project\n    ComputerName,\n    event_platform,\n    MachineDn,\n    UserName,\n    SensorGroupingTags,\n    MachineDomain,\n    SystemProductName,\n    BiosManufacturer,\n    event_simpleName,\n    aid,\n    cid,\n    OU\n| where UserName !hasprefix \"$\"\n//| where isnotempty(UserName) \n| where not  (UserName has_any (\"jsupport\", \"LOCAL SERVICE\",\"ejtvmp\",\"DWM\",\"UMFD\"))\n//| where isnotempty(SystemProductName)\n| summarize  make_set(event_platform), make_set(MachineDn), make_set(UserName), make_set(SensorGroupingTags), make_set(SystemProductName) , \nmake_set(BiosManufacturer),make_set(event_simpleName),make_set(aid),make_set(cid),make_set(OU) by ComputerName,aid, MachineDomain\n | project HostInfo=(strcat(\"Based on CS telemetry the host \", ComputerName,\" is a \", set_SystemProductName,  \" and is running the\", set_event_platform, \" OS \"\n\". It is in the \", set_OU, \" OU and on the \", MachineDomain, \" domain. \",\nset_UserName, \" is the user who last logged on to \", ComputerName)), \nCSHostDetails=(strcat(\"Host AID: \", aid, \" Host CID: \", set_cid, \n\". Host sensor group: \", set_SensorGroupingTags, \"Host AD group: \", set_MachineDn, \n\". Host BIOS Manafacturer is\", set_BiosManufacturer))","id":"46b61941-56ae-492d-9a4e-b38390969db6","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"database(\"Endpoint\").CrowdStrikeFalcon\n| where TimeGenerated between (_startTime .. _endTime) \n| where isnotempty(incidentDescription)\n| where endpointName contains (host_t)\n    or sourceEndpointHostName contains (host_t)\n    or targetEndpointHostName contains (host_t)\n| project\n    TimeGenerated,\n    userName,\n    sourceAccountUpn,\n    sourceAccountDomain,\n    incidentDescription,\n    detectName,\n    msg,\n    severityName,\n    sev,\n    endpointName,\n    sourceEndpointHostName,\n    record,\n    falconHostLink","id":"3d311d0f-fc60-402c-8ba1-440abd0bae35","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR \n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName contains (host_t) and event_simpleName == 'PythonFileWritten'\n| project\n    TimeGenerated,\n    ComputerName,\n    Info=strcat(event_simpleName, \" - \", FileName),\n    ImageFileName,\n    QuarantinedFileName,\n    SHA256HashData,\n    record","id":"174a707d-bbef-4571-9469-ba73c9e43a51","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime .. _endTime)  \n| where ComputerName contains (host_t) \n| where event_simpleName == 'DnsRequest'\n| where * contains (artifact_t)\n| project\n    TimeGenerated,\n    ComputerName,\n    event_simpleName,\n    DomainName,\n    RespondingDnsServer,\n    ContextProcessId,\n    ContextBaseFileName,\n    CNAMERecords,\n    IP4Records,IP6Records,FirstIP4Record, FirstIP6Record","id":"b0a7bad9-aaa1-4779-9c15-9182ebee1d6e","usedVariables":["_endTime","_startTime","artifact_t","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime .. _endTime)  \n| where ComputerName contains (host_t) \n| where event_simpleName == 'DnsRequest'\n| where * contains (artifact_t)\n| summarize c=count() by tostring(DomainName)","id":"90d868d8-0b95-4e98-bbcc-6d90a27e2de3","usedVariables":["_endTime","_startTime","artifact_t","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR \n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName contains (host_t) \n| where event_simpleName has_any (event_simpleName_t)\n| where * contains (artifact_t)\n| project ComputerName, event_simpleName\n| evaluate pivot(event_simpleName)","id":"d06c7471-e1d5-48ca-a1e7-f2371a910d0b","usedVariables":["_endTime","_startTime","artifact_t","event_simpleName_t","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR \n| where TimeGenerated between (_startTime.._endTime) \n| where ComputerName contains (host_t) and event_simpleName == 'InstalledBrowserExtension'\n| extend\n    BrowserFilePath = parse_json(record).BrowserFilePath,\n    BrowserProfileName = parse_json(record).BrowserProfileName,\n    BrowserExtensionVersion = parse_json(record).BrowserExtensionVersion,\n    BrowserExtensionName = parse_json(record).BrowserExtensionName\n| project TimeGenerated, ComputerName, BrowserFilePath,  BrowserExtensionName,BrowserExtensionVersion,BrowserProfileName\n| sort by tostring(BrowserExtensionName) asc","id":"ac2726bb-a67a-43cc-8677-a688818be51a","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName contains (host_t)\n| where event_simpleName == \"DcUsbDeviceConnected\" or event_simpleName == \"DcUsbDeviceDisconnected\"  \n| project\n    TimeGenerated,\n    ComputerName,\n    UserName,\n    event_simpleName,\n    DeviceManufacturer,\n    DeviceProduct,\n    DevicePropertyClassName,\n    DevicePropertyDeviceDescription,\n    DevicePropertyManufacturer,\n    DevicePropertyFriendlyName,\n    LocalAddressIP4,\n    record","id":"64ec6bef-0d34-41b2-87aa-0fec27258bec","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName contains (host_t)\n| where event_simpleName == \"ProcessInjection\" \n| extend\n    InjecteeImageFileName = parse_json(record).InjecteeImageFileName,\n    InjectorImageFileName = parse_json(record).InjectorImageFileName\n| project\n    TimeGenerated,\n    ComputerName,\n    InjecteeImageFileName,\n    InjectorImageFileName,\n    ModuleName,\n    event_simpleName,\n    ContextProcessId\n| sort by tostring(InjecteeImageFileName) asc\n","id":"9a9194e8-b185-4364-a1ce-6ef8e1177e57","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime .. _endTime)\n| where event_simpleName startswith_cs \"ActiveDirectory\"\n| where aid has (host_t) or SourceEndpointHostName startswith (host_t) or TargetEndpointHostName has (host_t) or ComputerName has (host_t)  or SamAccountName has (username_t) or SourceAccountUserName has (username_t)\n| project TimeGenerated, SourceDC=ComputerName, SourceEndpointHostName, SourceAccountUserName, name, TargetServiceAccessIdentifier, TargetServerHostName, TargetServerAddressIP4, SamAccountName, AccountDomain, SourceAccountDomain,LdapSearchBaseObjectSample,LdapSearchFilterSample,LdapSearchFilterShape","id":"4ce8fedc-62bd-44c7-900c-49d4932738c1","usedVariables":["_endTime","_startTime","host_t","username_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime .. _endTime)  //2 searches separated by an OR. First, search looks for hostname AND artifact (optional). Second, looks for Artifact only (hostname not required)\n| where (ComputerName == (host_t) and ((event_simpleName has 'NetworkConnect' or event_simpleName == 'FirewallRuleIP6Matched' or event_simpleName == 'FirewallRuleIP4Matched' or event_simpleName == 'NetworkReceiveAcceptIP4' or event_simpleName == 'NetworkReceiveAcceptIP6') and (RemoteAddressIP4 == (artifact_t) or RemoteAddressIP6 == (artifact_t)))) \n| project\n    TimeGenerated,\n    event_simpleName,\n    ComputerName,\n    ContextBaseFileName,\n    LocalAddressIP4,\n    LocalPort,\n    RemoteAddressIP4,\n    RemotePort,\n    geo_ip4=geo_info_from_ip_address(RemoteAddressIP4),\n    geo_ip6=geo_info_from_ip_address(RemoteAddressIP6),\n    RemoteAddressIP6,\n    LocalAddressIP6,\n    tostring(Protocol),\n    ConnectionDirection= parse_json(record).ConnectionDirection,\n    RuleAction= parse_json(record).RuleAction,\n    record\n| extend\n    IPProtocolType = case( \n                       Protocol == \"0\",\n                       \"IP\",\n                       Protocol == \"21\",\n                       \"ICMP\",\n                       Protocol == \"6\",\n                       \"TCP\",\n                       Protocol == \"17\",\n                       \"UDP\",\n                       Protocol == \"41\", \n                       \"IPV6\",\n                       Protocol == \"58\",\n                       \"ICMPV6\", \n                       Protocol == \"255\",\n                       \"UNKNOWN - Refer to CS Events Data Dictionary\",\n                       Protocol\n                   ), \n    ConnectionDirection = case( \n                          ConnectionDirection == \"0\",\n                          \"DIRECTION_OUTBOUND\",\n                          ConnectionDirection == \"1\",\n                          \"DIRECTION_INBOUND\",\n                          ConnectionDirection == \"2\",\n                          \"DIRECTION_NEITHER\",\n                          ConnectionDirection == \"3\",\n                          \"DIRECTION_BOTH\",\n                          ConnectionDirection == \"4\", \n                          \"DIRECTION_UNKNOWN\",\n                          ConnectionDirection\n                      ), \n    FirewallRuleAction = case( \n                         RuleAction == \"0\",\n                         \"RULE_ACTION_INVALID\",\n                         RuleAction == \"1\",\n                         \"RULE_ACTION_ALLOW\",\n                         RuleAction == \"2\",\n                         \"RULE_ACTION_DENY\",\n                         RuleAction\n                     ), \n    //Enrichment as of 11/18/2024. IPv4 and IPv6 Protocol have same values in Data Dictionary. \n    geo_ip = coalesce(geo_ip4, geo_ip6), \n    RemoteAddressIP = coalesce(RemoteAddressIP4, RemoteAddressIP6), \n    LocalAddressIP = coalesce(LocalAddressIP4, LocalAddressIP6)\n| project\n    TimeGenerated,\n    event_simpleName,\n    ComputerName,\n    IPProtocolType,\n    ContextBaseFileName,\n    LocalPort,\n    RemotePort,\n    LocalAddressIP,\n    RemoteAddressIP,\n    ConnectionDirection,\n    FirewallRuleAction,\n    IP_Country=tostring(geo_ip.country),\n    IP_City=tostring(geo_ip.city),\n    record","id":"cf793f13-2080-427a-8e76-d28225485de5","usedVariables":["_endTime","_startTime","artifact_t","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName contains (host_t)\n| where event_simpleName has_any (\"VolumeSnapshotDeleted\", \"VolumeSnapshotCreated\")\n| project\n    TimeGenerated,\n    event_simpleName,\n    ComputerName,\n    UserName,\n    VolumeSnapshotName,\n    VolumeName,\n    TargetFileName,\n    CommandLine,\n    FileName,\n    ImageFileName\n","id":"215ad230-cd3f-413a-a06a-914aeeafb11c","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime .. _endTime)\n| where event_simpleName startswith_cs \"UserLog\" and (ComputerName contains (host_t) or UserName has (username_t))\n| where not (UserName has_any (\"DWM\", \"UMFD\", \"jsupport\", \"LOCAL SERVICE\", \"SYSTEM\", \"ejtvmp\")) \n| project\n    TimeGenerated,\n    event_simpleName,\n    UserName,\n    LogonDomain,\n    LogonType = tostring(LogonType),\n    ClientComputerName,\n    aid,\n    LogonTime,\n    LogoffTime\n| extend LogonType = case(\n                         LogonType == \"0\",\n                         \"System\",\n                         LogonType == \"2\",\n                         \"Interactive\",\n                         LogonType == \"3\",\n                         \"Network\",\n                         LogonType == \"4\",\n                         \"Batch\",\n                         LogonType == \"5\",\n                         \"Service\",\n                         LogonType == \"7\" and event_simpleName == \"UserLogon\",\n                         \"Unlock\",\n                         LogonType == \"7\" and event_simpleName == \"UserLogoff\",\n                         \"Lock\",\n                         LogonType == \"7\" and event_simpleName == \"UserLogonFailed2\",\n                         \"Unlock Attempt\",\n                         LogonType == \"9\",\n                         \"NewCredentials\",\n                         LogonType == \"10\",\n                         \"RemoteInteractive\",\n                         LogonType == \"11\",\n                         \"CachedInteractive\",\n                         LogonType\n                     )\n| sort by ClientComputerName, TimeGenerated asc","id":"479282b5-c670-4ee5-889d-3b2057bb5295","usedVariables":["_endTime","_startTime","host_t","username_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR \n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName contains (host_t) \n| where event_simpleName == 'AgentOnline' or event_simpleName == 'FirmwareImageAnalyzed'\n    or event_simpleName == 'FirmwareImageCheck' \n| project\n    event_simpleName,\n    ComputerName,\n    SourceAccountUserName,\n    AgentVersion,\n    BiosVersion,\n    BiosReleaseDate,\n    BiosManufacturer,\n    TpmManufacturer,\n    SystemSku,\n    MoboProductName,\n    PlatformSecuritySettings,\n    SystemProductName,\n    SystemSerialNumber,\n    TpmFirmwareVersion,\n    MdmDeviceId,\n    FirmwareSize,\n    FirmwareType,\n    ConfigBuild,\n    NumberOfMeasurements,\n    SHA256HashData\n","id":"2845ff38-1015-4e49-9ab5-8b63de7ba57d","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime .. _endTime)\n| where event_simpleName == \"EmailArchiveFileWritten\"\n| where  ComputerName == (host_t)  or TargetFileName contains (username_t)\n| project TimeGenerated,event_simpleName, ComputerName, FileName,TargetFileName, ContextBaseFileName","id":"bb566022-a1e3-4698-ad88-d70462a33edd","usedVariables":["_endTime","_startTime","host_t","username_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime .. _endTime)\n| where event_simpleName == \"FsVolumeMounted\"\n| where  ComputerName == (host_t)  or VirtualDriveFileName contains (username_t )\n| project  TimeGenerated,event_simpleName,ComputerName, User_Profile_VHDX_FileName=extract_all(\"(\\\\w+\\\\.VHDX)\", VirtualDriveFileName),AzureNetAppDeviceName=VirtualDriveFileName, DiskParentDeviceInstanceId,VolumeFileSystemDriver, VolumeSessionUUID, VolumeMountPoint, VolumeDriveLetter\n| sort by AzureNetAppDeviceName","id":"31342c99-8362-4660-a849-57f78aefd63b","usedVariables":["_endTime","_startTime","host_t","username_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime .. _endTime)\n| where event_simpleName endswith \"FileWritten\"\n| where  ComputerName == (host_t)  or TargetFileName contains (username_t)\n| project\n    TimeGenerated,\n    ComputerName,\n    UserName,\n    CommandLine,\n    event_simpleName,\n    FileName,\n    TargetFileName,\n    ContextImageFileName,\n    ContextBaseFileName,\n    TemporaryFileName","id":"ba4fbbe6-b4e8-4f4b-849b-c474a65e958e","usedVariables":["_endTime","_startTime","host_t","username_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName == (host_t) or UserName == (username_t)\n| where event_simpleName == 'AssociateIndicator'\n| project-reorder TimeGenerated,TargetProcessId,cid, ComputerName,UserName, OU, SensorGroupingTags","id":"3db81965-f04d-435d-8753-5d1b3fbf4406","usedVariables":["_endTime","_startTime","host_t","username_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName == (host_t) \n| search (Process_t)\n| project-reorder\n    TimeGenerated,\n    ComputerName,\n    event_simpleName,\n    FileName,\n    ContextBaseFileName,\n    ImageFileName,\n    TargetFileName,\n    ParentBaseFileName,\n    GrandParentBaseFileName,\n    QuarantinedFileName,\n    CommandLine,\n    record","id":"1f24d71d-9fb0-403a-b5bd-7461e46d2503","usedVariables":["Process_t","_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR \n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName == (host_t) \n| search (Process_t)\n| summarize logs = make_set(record) by event_simpleName\n","id":"57a7d018-55a8-4a79-9987-9f98e2749d51","usedVariables":["Process_t","_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR \n| where TimeGenerated between (_startTime .. _endTime) \n| where ComputerName contains (host_t) and event_platform == 'Mac'\n| where TargetFileName matches regex '/Users/\\\\w+/Downloads/'\n| project\n    TimeGenerated,\n    event_simpleName,\n    FileName,\n    TargetFileName,\n    ContextImageFileName,\n    OriginalFilename,\n    User,\n    ComputerName,\n    record","id":"edbb3c8a-5c21-454e-a4af-a7315be762fd","usedVariables":["_endTime","_startTime","host_t"]},{"dataSource":{"kind":"inline","dataSourceId":"e2531940-8a59-446c-8122-da1fb5dc7e6f"},"text":"CrowdStrikeFDR\n| where TimeGenerated between (_startTime.._endTime)\n| where ComputerName contains (host_t)\n| extend event_simpleName = tostring(parse_json(record).event_simpleName)\n| summarize by event_simpleName\n| sort by event_simpleName asc  ","id":"072fda9c-c727-4f92-bd7f-bed1079cacda","usedVariables":["_endTime","_startTime","host_t"]}]}
